专题开发（针对日常专题，供【前端人员】参考）
============

Author: 谢璇

## 专题开发，包括日常，总共有几种场景？
* 3 种场景：
    1. 日常：专题在线上，只存活 1 周左右
    2. 大促：一般大促分 2 个阶段（大促预热、大促），预热时间 1 周左右，大促时间 1~4 天
    3. 内容性：一直存在，如：秒杀专题页面
* 无论何种场景，前端开发过程，都是基于 “设计稿”，通过 “挂件+代码” 的方式
* 本文档，只针对 “日常专题”

## 专题开发流程
* 整体开发周期
    1. 以 1 周，为 1 个排期周期
    2. 【运营人员】制订本周排期的 “排期表”（其中，包含了专题数量、专题对应运营负责人、页面复杂度、上线时间）
    3. 【前端人员】在上述 “排期表” 中，补充 “前端定稿时间”、“前端负责人”
    4. 【设计人员】接着在 “排期表” 中，补充 “设计定稿时间”、“设计负责人”
    5. 进行 “专题制作”
* 具体专题制作
    1. 【运营人员】提供文案 Demo
    2. 【设计人员】制作页面 PSD
    3. 【前端人员】制作页面
    4. 【运营人员】在页面上配置 “商品信息” 和 “链接”
* 注意事项
    * “排期表” 中一个专题，一般对应的是 PC、H5（H5 页面默认支持 APP 嵌入）两个页面，意味着 “设计稿” 也会有两份
    * 上线时间（如：2016-04-08）指的都是，当天上午（大概 10 点）要发布出去
    * 上线前，【运营人员】需要预留 1 天的时间配置 “商品信息” （不仅要选品，还要协调 “采购” 等相关人员准备 “商品”，在上线前后也 “很可能” 需要更换商品）
    * 所有的 “定稿时间”，都默认为工作日，且为当天下班前（如：“设计定稿时间” 为 2016-04-07，即为 7 号下班前给设计稿）
    * “前端定稿时间” 一般情况下，是 “上线时间” 前 2 天（如：周一上线，前一周的周五要预留给【运营人员】配商品，“前端定稿时间” 就得是 “前一周的周四”）
    * 对于日常专题，没有 “测试人员” 支持

* 排期表示例：
<br />
![](http://img04.bubugao.com/153f3b33d12_bc_38bde669424d2da920f2b0baeff62eb9_1334x123.png)

## 专题类型
* 简单专题：之所以简单，是只有这类专题，无需【前端人员】参考，【运营人员】得到 “设计稿” 之后，自己就能在 BMMS 中添加挂件，完成页面
* 复杂专题：不涉及过多定制化需求，大多可以通过 “挂件+少量 CSS、JS 代码” 即可完成
* 定制复杂专题：有很多定制化动画特效，需要【设计人员】在制作 “设计稿” 前，提前和【前端人员】沟通技术可行性

## 前端开发步骤
1. 得到 “设计稿” 之后，分析确定页面实现
    * 其中每一块，可不可以用现有挂件
    * 有没有兼容性问题风险
    * 如果感觉 UE 不合理的地方，一开始就提醒相关运营、设计
2. 进行切图，同时把 “带有切图线的设计稿” 另存为 PSD 格式
    <br />
    因为，上线前后有可能会更换图，如果在 “带有切图线的设计稿” 基础上修改局部，可以方便切图
    <br />
    注：不要把原 PSD 覆盖，可以在原 PSD 名称后加一个 “美妆-七夕(切图结果).psd”
    <br />
    切图图片结果，也最好备份一段时间
3. 在 BMMS 中，新建页面
    * 指定业态
    * 页面标题，取一个大体接近专题主题的名字（【运营人员】之后，可以自行修改）
    * 页面 URL，直接用 BMMS 随机生成的（【运营人员】之后，可以自行修改）
    * “页面模板” 选择项，PC 页面选择【PC-1（默认空白）】，H5 页面选择【H5-1（默认空白）】
4. 制作页面
    * 添加挂件，上传图片（如：一开始都需要添加个【顶部头图】的挂件，并上传切图图片）
    * 如果需要用到【图片绑定商品价格】挂件，需要提前要求【运营人员】给到 “相关商品ID”
    * 部分 BMMS 挂件不支持的功能，先去专题组件库看下是否有封装好的（如：倒计时、Tab 页签切换）
    * 顺带一提的是，BMMS 编辑的页面，发布之后有缓存机制（针对正式页面内容）
        <br />
        清缓存有 2 种途径：
        1. 手工点击 “页面列表” 或 “可视化编辑页面” 中的 “刷新”、“发布” 按钮
        2. BMMS 会在定点（如：6 点、7 点、8 点……）定时清缓存
5. 完成之后，通知运营
    * 告知是哪一个专题
    * 提供新建页面的 URL

## 如何添加现有 BMMS 挂件？
* 以【顶部大图】挂件的使用为例
* 步骤
    1. 进入 “可视化” 编辑页面
    <br />
    ![](http://img04.bubugao.com/153f405c592_bc_17f49eb1f48a477095ee04eb6bc8a90d_1128x45.png)
    2. 添加挂件
    <br />
    ![](http://img04.bubugao.com/153f40a4e77_bc_70d3247a3b4c20b9553515f769eb85c3_586x100.png)
    3. 选择挂件类型
    <br />
    ![](http://img04.bubugao.com/153f40f2bbc_bc_f50528e0d272b8671a8aee417a8ea91d_437x251.png)
    <br />
    说明：BMMS 的挂件，存在层次结构（即：挂件类型 -> 挂件模板）
    <br />
    不同的 “挂件类型” 其挂件数据结构不同，相应的 “挂件编辑框” 也不同
    <br />
    （比如这里的【顶部大图】挂件，它是属于 “新图片挂件” 类型）
    4. 选择挂件模板
    <br />
    ![](http://img04.bubugao.com/153f41534db_bc_a430eb53b656ebb599fd01438fef3745_157x209.png)
    <br />
    一种 “挂件类型” 下，会有多个 【挂件模板】。并且，在保留数据不变的情况下，同种 “挂件类型” 的 【挂件模板】 可以互相更换
    <br />
    如：一个使用了 “新图片挂件” 类型的 【顶部大图】 挂件模板的挂件，可以更换成 “新图片挂件” 类型的 【图片列表】 挂件模板
    <br />
    但：一个使用了 “新图片挂件” 类型的 【顶部大图】 挂件模板的挂件，不能更换成 “商品列表” 类型的 【商品列表 1 行 3 个】 挂件模板
    5. 编辑挂件数据
    <br />
    ![](http://img04.bubugao.com/153f41cf053_bc_18e1867efbc5721cf262d357d7e93296_444x77.png)
    6. 上传图片
    <br />
    ![](http://img04.bubugao.com/153f41fa6b3_bc_2435ca41e14443bd963f3efef8423818_1010x145.png)
    <br />
    注：这里支持多选图片上传
* 说明
    * 挂件提供了数据录入、图片上传，具体展示是由【前端人员】在 “创建挂件模板” 时定义好的（如：【顶部大图】的 HTML 结构）
    * 在 “挂件模板” 选择列表，点击 “编辑” 挂件模板
        <br />
        ![](http://img04.bubugao.com/153f425183c_bc_b2a766b94e3cde3819ade3f52f88a5e4_151x209.png)
    * 切换到 “模板内容”
        <br />
        ![](http://img04.bubugao.com/153f4265561_bc_a0f6b94980ea4d02f009b01ae54ffd63_636x190.png)

## 没有用的上的 BMMS 挂件，自己编辑 HTML
* 方案一：编辑页面
    1. “可视化编辑界面” 点击右上角的 “编辑模板” 按钮
* 方案二：添加私有挂件
    1. 添加一个新挂件
    2. 随便选一个 “挂件类型”
    3. 点击弹出框左上角的 “创建模板” 按钮
    4. “模板名称” 随便取一个你记得住的，“模板类型” 选择 “私有模板”
    5. “模板内容” 中，编辑为你想要的 HTML
    6. 如果想加 CSS 在 head 中，采用【方案一】的方式，编辑页面

## 专题项目结构
* m-topic：http://fe.bubugao-inc.com/specs/doc/topic/directory-pc.md
* pc-topic：http://fe.bubugao-inc.com/specs/doc/topic/directory-h5.md
